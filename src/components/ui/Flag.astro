---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  countryCode: string;
  size?: 'sm' | 'md' | 'lg';
  class?: string;
}

const { countryCode, size = 'md', class: className = '' } = Astro.props;

// Size mappings
const sizes = {
  sm: { width: 16, height: 12 },
  md: { width: 24, height: 18 },
  lg: { width: 32, height: 24 },
};

const { width, height } = sizes[size];

// Import all flag SVGs
const flags: Record<string, { default: ImageMetadata }> = import.meta.glob('/public/flags/*.svg', { eager: true });
const flagPath = `/public/flags/${countryCode.toLowerCase()}.svg`;
const flagSrc = flags[flagPath];

if (!flagSrc) {
  throw new Error(`Flag not found for country code: ${countryCode}`);
}
---

<span 
  class={`inline-flex items-center ${className}`}
  style={`width: ${width}px; height: ${height}px;`}
>
  <Image
    src={flagSrc.default}
    alt={`Flag of ${countryCode}`}
    width={width}
    height={height}
    class="w-full h-full object-contain"
  />
</span>
